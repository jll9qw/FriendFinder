<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Survey Page</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
  </head>

  <body>
    <div class="container">
      <div class="jumbotron">
        <h1 class="text-center">
          <span class="fa fa-heart"></span> Friend Finder
        </h1>
        <hr />
        <h2 class="text-center">Compatibility Quiz</h2>
        <br />
        <div class="text-center">
          <a href="/api/friends">
            <button class="btn btn-lg btn-primary">
              <span class="fa fa-list-alt"></span> View Friends
            </button>
          </a>
          <a href="/">
            <button class="btn btn-lg btn-default">
              <span class="fa fa-home"></span>
            </button>
          </a>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-12">
          <!-- Survey Page -->
          <div class="card">
            <div class="card-header">
              Complete the survey
            </div>
            <div class="card-body">
              <form role="form">
                <div class="form-group">
                  <label for="form-name">Name</label>
                  <input type="text" class="form-control" id="form-name" />
                </div>
                <div class="form-group">
                  <label for="form-picture-id">Link to Photo Image (Required)
                </label>
                  <input
                    type="text"
                    class="form-control"
                    id="form-picture-id"
                  />
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You are an introvert</label>
                    <select class="form-control" id="q1" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You enjoy immediate gratification</label>
                    <select class="form-control" id="q2" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You play an instrument</label>
                    <select class="form-control" id="q3">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You are an ambitious person</label>
                    <select class="form-control" id="q4" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You prefer candy over flowers</label>
                    <select class="form-control" id="q5" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You prefer a sporting event over a movie</label>
                    <select class="form-control" id="q6" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You are a workaholic</label>
                    <select class="form-control" id="q7" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You prefer a good book over a movie</label>
                    <select class="form-control" id="q8" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You would go "dutch" on the first date</label>
                    <select class="form-control" id="q9" class = "questions">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="exampleFormControlSelect1">You would consider yourself an extrovert</label>
                    <select class="form-control" id="q10">
                      <option>1 (Strongly Disagree)</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4</option>
                      <option>5 (Strongly Agree)</option>
                    </select>
                  </div>
                </div>
                <button type="submit" class="btn btn-primary submit">
                  Submit
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id ="results-modal" class = "modal fade" role= "dialog">
      <div class = "modal-dialog">
        <div class = "modal-content">
          <div class="modal-header">
            <buttton type="button" class="close" data-dismiss="modal">X</buttton>
            <h2 class="modal-title">
              <strong>Best Match!!!</strong>
            </h2>
            <div class="modal-body">
              <h2 id ="match-name"></h2>
              <img id="match-pic" src ="">
            </div>
            <div class="modal-footer">
              <button type="button" class= "btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script type="text/javascript">
      // In this code below we create the Front-end JavaScript which "POSTS" our form data to our express server.
      // var config ={
      //   ".chosen-select":{},
      //   ".chosen-select-deselect":{
      //     allow_single_deselect:  true
      //   },
      //   ".chosen-select-no-single":{
      //     disable_search_threshold: 10
      //   },
      //   ".chosen-select-no-results":{
      //     no_results_text: "Nobody found...for now"
      //   },
      //   ".chosen-select-width":{
      //     width:"95%"
      //   }
      // };

      // for (selector in config){
      //   $(selector).chosen(config[selector]);
      // }




      $('.submit').on('click', function(event) {
        event.preventDefault();
        
        //Form validation
        function validateForm(){
          var isValid = true;
          $(".form-control").each(function(){
            if ($(this).val()===""){
              isValid = false;
            }
          });
          return isValid;

        }

        // If all the fields are captured
        if (validateForm()){

        // Captures the form inputs 
        var newFriend = {
          name: $('#form-name')
            .val()
            .trim(),
         
          pic: $('#form-picture-id')
            .val()
            .trim(),
            score: [
                $("#q1").val(),
					$("#q2").val(),
					$("#q3").val(),
					$("#q4").val(),
					$("#q5").val(),
					$("#q6").val(),
					$("#q7").val(),
					$("#q8").val(),
					$("#q9").val(),
					$("#q10").val()
]
        };
// Ajax post to the API
$.post("api/friends", newFriend, function(data){

  // Displaying the results
  $("#match-name").text(data.name);
  $("#match-img").attr("src", data.pic);

  $("#results-modal").modal('toogle');


});
        } else{
          alert("Please fill out the form")
        }

        $.ajax({
          url: '/api/friends',
          method: 'POST',
          data: newFriend
        }).then(function(data) {

        });


          // Clear the form when submitting
          $('#form-name').val('');
          $('#form-picture-id').val('');
          $('.questions').val('');
        });
    
    </script>
  </body>
</html>
